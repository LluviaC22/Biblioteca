{"ast":null,"code":"import axios from 'axios';\n\n// Función para verificar si el usuario está autenticado\nexport const isAuthenticated = () => {\n  const token = localStorage.getItem('token');\n  console.log('Token encontrado:', token); // Para verificar en la consola\n  return !!token; // Devuelve true si hay un token\n};\n\n// Función para obtener el token\nexport const getToken = () => {\n  return localStorage.getItem('token');\n};\n\n// Función para guardar el token\nexport const setToken = token => {\n  localStorage.setItem('token', token);\n};\n\n// Función para eliminar el token (logout)\nexport const removeToken = () => {\n  localStorage.removeItem('token');\n};\n\n// Función para realizar el login\nexport const login = async (email, contrasena) => {\n  try {\n    const response = await axios.post('http://localhost:8000/login', {\n      email,\n      contrasena\n    });\n    const {\n      token\n    } = response.data;\n    setToken(token);\n    return true;\n  } catch (error) {\n    console.error('Error durante el login:', error);\n    return false;\n  }\n};\n\n// Función para realizar el logout\nexport const logout = () => {\n  localStorage.removeItem('token'); // Elimina el token del localStorage\n  // Aquí también puedes hacer otras acciones si es necesario, como restablecer el estado global de la aplicación.\n};\n\n// Configurar axios para incluir el token en todas las peticiones\naxios.interceptors.request.use(config => {\n  const token = getToken();\n  if (token) {\n    config.headers['Authorization'] = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Manejar errores de autenticación globalmente\naxios.interceptors.response.use(response => response, error => {\n  if (error.response && (error.response.status === 401 || error.response.status === 403)) {\n    // Token no válido o expirado\n    removeToken();\n    // Aquí puedes agregar lógica adicional, como redirigir al login\n    window.location.href = '/login';\n  }\n  return Promise.reject(error);\n});","map":{"version":3,"names":["axios","isAuthenticated","token","localStorage","getItem","console","log","getToken","setToken","setItem","removeToken","removeItem","login","email","contrasena","response","post","data","error","logout","interceptors","request","use","config","headers","Promise","reject","status","window","location","href"],"sources":["C:/Biblioteca Pública/my-react/src/components/Autenticacion/auth.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Función para verificar si el usuario está autenticado\r\nexport const isAuthenticated = () => {\r\n  const token = localStorage.getItem('token');\r\n  console.log('Token encontrado:', token); // Para verificar en la consola\r\n  return !!token; // Devuelve true si hay un token\r\n};\r\n\r\n\r\n// Función para obtener el token\r\nexport const getToken = () => {\r\n  return localStorage.getItem('token');\r\n};\r\n\r\n// Función para guardar el token\r\nexport const setToken = (token) => {\r\n  localStorage.setItem('token', token);\r\n};\r\n\r\n// Función para eliminar el token (logout)\r\nexport const removeToken = () => {\r\n  localStorage.removeItem('token');\r\n};\r\n\r\n// Función para realizar el login\r\nexport const login = async (email, contrasena) => {\r\n  try {\r\n    const response = await axios.post('http://localhost:8000/login', { email, contrasena });\r\n    const { token } = response.data;\r\n    setToken(token);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error durante el login:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n// Función para realizar el logout\r\nexport const logout = () => {\r\n  localStorage.removeItem('token'); // Elimina el token del localStorage\r\n  // Aquí también puedes hacer otras acciones si es necesario, como restablecer el estado global de la aplicación.\r\n};\r\n\r\n// Configurar axios para incluir el token en todas las peticiones\r\naxios.interceptors.request.use(\r\n  (config) => {\r\n    const token = getToken();\r\n    if (token) {\r\n      config.headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Manejar errores de autenticación globalmente\r\naxios.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.response && (error.response.status === 401 || error.response.status === 403)) {\r\n      // Token no válido o expirado\r\n      removeToken();\r\n      // Aquí puedes agregar lógica adicional, como redirigir al login\r\n      window.location.href = '/login';\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;;AAEzB;AACA,OAAO,MAAMC,eAAe,GAAGA,CAAA,KAAM;EACnC,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3CC,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEJ,KAAK,CAAC,CAAC,CAAC;EACzC,OAAO,CAAC,CAACA,KAAK,CAAC,CAAC;AAClB,CAAC;;AAGD;AACA,OAAO,MAAMK,QAAQ,GAAGA,CAAA,KAAM;EAC5B,OAAOJ,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;AACtC,CAAC;;AAED;AACA,OAAO,MAAMI,QAAQ,GAAIN,KAAK,IAAK;EACjCC,YAAY,CAACM,OAAO,CAAC,OAAO,EAAEP,KAAK,CAAC;AACtC,CAAC;;AAED;AACA,OAAO,MAAMQ,WAAW,GAAGA,CAAA,KAAM;EAC/BP,YAAY,CAACQ,UAAU,CAAC,OAAO,CAAC;AAClC,CAAC;;AAED;AACA,OAAO,MAAMC,KAAK,GAAG,MAAAA,CAAOC,KAAK,EAAEC,UAAU,KAAK;EAChD,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMf,KAAK,CAACgB,IAAI,CAAC,6BAA6B,EAAE;MAAEH,KAAK;MAAEC;IAAW,CAAC,CAAC;IACvF,MAAM;MAAEZ;IAAM,CAAC,GAAGa,QAAQ,CAACE,IAAI;IAC/BT,QAAQ,CAACN,KAAK,CAAC;IACf,OAAO,IAAI;EACb,CAAC,CAAC,OAAOgB,KAAK,EAAE;IACdb,OAAO,CAACa,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IAC/C,OAAO,KAAK;EACd;AACF,CAAC;;AAED;AACA,OAAO,MAAMC,MAAM,GAAGA,CAAA,KAAM;EAC1BhB,YAAY,CAACQ,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC;EAClC;AACF,CAAC;;AAED;AACAX,KAAK,CAACoB,YAAY,CAACC,OAAO,CAACC,GAAG,CAC3BC,MAAM,IAAK;EACV,MAAMrB,KAAK,GAAGK,QAAQ,CAAC,CAAC;EACxB,IAAIL,KAAK,EAAE;IACTqB,MAAM,CAACC,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUtB,KAAK,EAAE;EACrD;EACA,OAAOqB,MAAM;AACf,CAAC,EACAL,KAAK,IAAK;EACT,OAAOO,OAAO,CAACC,MAAM,CAACR,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACAlB,KAAK,CAACoB,YAAY,CAACL,QAAQ,CAACO,GAAG,CAC5BP,QAAQ,IAAKA,QAAQ,EACrBG,KAAK,IAAK;EACT,IAAIA,KAAK,CAACH,QAAQ,KAAKG,KAAK,CAACH,QAAQ,CAACY,MAAM,KAAK,GAAG,IAAIT,KAAK,CAACH,QAAQ,CAACY,MAAM,KAAK,GAAG,CAAC,EAAE;IACtF;IACAjB,WAAW,CAAC,CAAC;IACb;IACAkB,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;EACjC;EACA,OAAOL,OAAO,CAACC,MAAM,CAACR,KAAK,CAAC;AAC9B,CACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}