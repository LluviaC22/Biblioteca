{"ast":null,"code":"import axios from'axios';import{useState,useEffect}from'react';import{Link}from'react-router-dom';import{Modal,Button}from'react-bootstrap';import'./ShowUsuarios.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const URI='http://localhost:8000/usuarios';const CompShowUsuarios=()=>{const[usuarios,setUsuarios]=useState([]);const[showModal,setShowModal]=useState(false);// Estado para el modal\nconst[message,setMessage]=useState('');// Mensaje del modal\nconst[usuarioToDelete,setUsuarioToDelete]=useState(null);// ID del usuario a eliminar\nuseEffect(()=>{getUsuarios();},[]);const getUsuarios=async()=>{try{const res=await axios.get(URI,{headers:{\"Authorization\":`Bearer ${localStorage.getItem(\"token\")}`}});setUsuarios(res.data);}catch(error){console.error(\"Error al obtener los usuarios:\",error);if(error.response){console.log(\"Código de estado:\",error.response.status);console.log(\"Mensaje de error:\",error.response.data);if(error.response.status===403){alert(\"No tienes permiso para acceder a esta página.\");}}else{console.error(\"Error de solicitud:\",error.message);}}};const deleteUsuario=async id_usuario=>{const token=localStorage.getItem('token');try{await axios.delete(`${URI}/${id_usuario}`,{headers:{'Authorization':`Bearer ${token}`}});setMessage('Usuario eliminado con éxito');setShowModal(true);// Mostrar modal de éxito\ngetUsuarios();// Actualizar la lista de usuarios\n}catch(error){console.error('Error al eliminar el usuario:',error);if(error.response){console.log('Código de estado:',error.response.status);console.log('Mensaje de error:',error.response.data);}setMessage('Hubo un error al eliminar el usuario');setShowModal(true);// Mostrar modal de error\n}};const handleClose=()=>{setShowModal(false);// Cerrar el modal\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"vista-usuarios-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[/*#__PURE__*/_jsx(Link,{to:\"/create-usuario\",className:\"btn-crear-usuario mb-3\",children:\"Crear Usuario\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table-usuarios\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"text-center\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:usuarios.map(usuario=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:usuario.nombre}),/*#__PURE__*/_jsx(\"td\",{children:usuario.email}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"boton-group\",role:\"group\",children:[/*#__PURE__*/_jsx(Link,{to:`/edit-usuario/${usuario.id_usuario}`,className:\"boton-editar\",children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteUsuario(usuario.id_usuario),className:\"boton-eliminar\",children:\"Eliminar\"})]})})]},usuario.id_usuario))})]})})]})}),/*#__PURE__*/_jsxs(Modal,{show:showModal,onHide:handleClose,centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:message.startsWith('Error')?'¡Error!':'¡Éxito!'})}),/*#__PURE__*/_jsx(Modal.Body,{children:message}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleClose,children:\"Aceptar\"})})]})]});};export default CompShowUsuarios;","map":{"version":3,"names":["axios","useState","useEffect","Link","Modal","Button","jsx","_jsx","jsxs","_jsxs","URI","CompShowUsuarios","usuarios","setUsuarios","showModal","setShowModal","message","setMessage","usuarioToDelete","setUsuarioToDelete","getUsuarios","res","get","headers","localStorage","getItem","data","error","console","response","log","status","alert","deleteUsuario","id_usuario","token","delete","handleClose","className","children","to","map","usuario","nombre","email","role","onClick","show","onHide","centered","Header","closeButton","Title","startsWith","Body","Footer","variant"],"sources":["C:/BibliotecaPublica/my-react/src/usuario/ShowUsuarios.js"],"sourcesContent":["import axios from 'axios';\r\nimport { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { Modal, Button } from 'react-bootstrap';\r\nimport './ShowUsuarios.css';\r\n\r\nconst URI = 'http://localhost:8000/usuarios';\r\n\r\nconst CompShowUsuarios = () => {\r\n    const [usuarios, setUsuarios] = useState([]);\r\n    const [showModal, setShowModal] = useState(false); // Estado para el modal\r\n    const [message, setMessage] = useState(''); // Mensaje del modal\r\n    const [usuarioToDelete, setUsuarioToDelete] = useState(null); // ID del usuario a eliminar\r\n\r\n    useEffect(() => {\r\n        getUsuarios();\r\n    }, []);\r\n\r\n    const getUsuarios = async () => {\r\n        try {\r\n            const res = await axios.get(URI, {\r\n                headers: {\r\n                    \"Authorization\": `Bearer ${localStorage.getItem(\"token\")}`\r\n                }\r\n            });\r\n            setUsuarios(res.data);\r\n        } catch (error) {\r\n            console.error(\"Error al obtener los usuarios:\", error);\r\n            if (error.response) {\r\n                console.log(\"Código de estado:\", error.response.status);\r\n                console.log(\"Mensaje de error:\", error.response.data);\r\n                if (error.response.status === 403) {\r\n                    alert(\"No tienes permiso para acceder a esta página.\");\r\n                }\r\n            } else {\r\n                console.error(\"Error de solicitud:\", error.message);\r\n            }\r\n        }\r\n    };\r\n\r\n    const deleteUsuario = async (id_usuario) => {\r\n        const token = localStorage.getItem('token');\r\n        try {\r\n            await axios.delete(`${URI}/${id_usuario}`, {\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                },\r\n            });\r\n            setMessage('Usuario eliminado con éxito');\r\n            setShowModal(true); // Mostrar modal de éxito\r\n            getUsuarios(); // Actualizar la lista de usuarios\r\n        } catch (error) {\r\n            console.error('Error al eliminar el usuario:', error);\r\n            if (error.response) {\r\n                console.log('Código de estado:', error.response.status);\r\n                console.log('Mensaje de error:', error.response.data);\r\n            }\r\n            setMessage('Hubo un error al eliminar el usuario');\r\n            setShowModal(true); // Mostrar modal de error\r\n        }\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setShowModal(false);  // Cerrar el modal\r\n    };\r\n\r\n    return (\r\n        <div className=\"vista-usuarios-container\">\r\n            <div className=\"row\">\r\n                <div className=\"col\">\r\n                    <Link \r\n                        to=\"/create-usuario\" \r\n                        className=\"btn-crear-usuario mb-3\"\r\n                    >\r\n                        Crear Usuario\r\n                    </Link>\r\n\r\n                    <div className=\"table-responsive\">\r\n                        <table className=\"table-usuarios\">\r\n                            <thead className=\"text-center\">\r\n                                <tr>\r\n                                    <th>Nombre</th>\r\n                                    <th>Email</th>\r\n                                    <th>Acciones</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {usuarios.map((usuario) => (\r\n                                    <tr key={usuario.id_usuario}>\r\n                                        <td>{usuario.nombre}</td>\r\n                                        <td>{usuario.email}</td>\r\n                                        <td className=\"text-center\">\r\n                                            <div className=\"boton-group\" role=\"group\">\r\n                                                <Link \r\n                                                    to={`/edit-usuario/${usuario.id_usuario}`} \r\n                                                    className=\"boton-editar\"\r\n                                                >\r\n                                                    Editar\r\n                                                </Link>\r\n                                                <button \r\n                                                    onClick={() => deleteUsuario(usuario.id_usuario)} \r\n                                                    className=\"boton-eliminar\"\r\n                                                >\r\n                                                    Eliminar\r\n                                                </button>\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Modal de confirmación */}\r\n            <Modal show={showModal} onHide={handleClose} centered>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>{message.startsWith('Error') ? '¡Error!' : '¡Éxito!'}</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>{message}</Modal.Body>\r\n                <Modal.Footer>\r\n                    <Button variant=\"primary\" onClick={handleClose}>\r\n                        Aceptar\r\n                    </Button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CompShowUsuarios;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}